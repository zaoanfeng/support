# 一键安装包定制开发手册

## 目录介绍

--------- bin   #可执行脚本文件夹

    --------------- install.bat   #安装服务执行脚本
    --------------- uninstall.bat    #卸载服务执行脚本
    --------------- startService.bat    #启动所有服务
    --------------- stopService.bat    #关闭所有服务

--------- config   #配置文件存入目录

    --------------- config.properties    #安装初始化时使用的参数配置

--------- data   #shopweb初始化数据

    --------------- store.sql    #启动时执行的sql语句

--------- tomcat-xxx    #tomcat软件

    --------------- webapps\shopweb    #shopweb软件包

--------- jdk-xxx

    --------------- jre    #绿色版jre

--------- integration-xxx    #对接软件包
--------- eslworking-xxx    #ESL-Working软件
--------- mysql-xxx    #mysql绿色版软件
--------- doc    #定制、使用等相关文档

## 应用软件的配置

### MySQL数据库创建

1. 进入到bin目录下，执行 install.bat文件，一键安装服务，服务安装完成，单独开启mysql服务，创建需要的数据库，mysql数据库root默认密码为admin。

2. MySQL的卸载、安装
进入到MySQL的bin目录下执行服务的卸载与安装

       mysqld --remove Hanshow-MySQL    #卸载服务
       mysqld --install Hanshow-MySQL   #安装服务

++_@执行install.bat\uninstall.bat时需要以管理员权限执行_++

### Shopweb定制

1. shopweb基本配置
根据自己的需求，进行配置，配置方式同单独安装方式一致， 配置完成后，启动Tomcat服务，Shopweb应用会自动建表。

2. tomcat内存修改
打开tomcat/bin下的service.bat文件，在setlocal下增加/修改内存配置，修改完内存需要重新安装服务

       set "JvmMs=512"     #tomcat使用最小内存
       set "JvmMx=1024"    #tomcat使用最大内存

3. 服务的卸载、安装
进入到tomcat的bin目录下执行服务的卸载与安装

       service.bat remove Hanshow-Tomcat     #卸载服务
       service.bat install Hanshow-Tomcat    #安装服务

++_@Shopweb版本为1.5.x及以上，不支持Shopweb2.0及以上版本_++

### ESL-Working定制

1. 根据自己的需求，将模板字体放到对应目录下、完成配置文件的修改，同单独安装方式一致。

2. 服务的卸载、安装
进入到eslworking的bin目录下执行服务的卸载与安装

       service.bat remove      #卸载服务
       service.bat install     #安装服务

++_@ESL-Working版本不支持3.0及以上版本_++

### 对接模块定制

1. 根据自己的需求，进行配置，同单独安装方式一致。

2. 服务的卸载、安装
进入到integration的bin目录下执行服务的卸载与安装

       双击 uninstall.bat 卸载
       双击 install.bat 安装


## 软件打包

### 初始化数据

应用软件配置完成后，执行uninstall.bat将服务进行卸载后重装，软件在安装服务时，Shopweb中的门店信息会根据config.properties中的设定的门店编号、客户门店编号、门店名进行初始化。将修改ESL-Working配置中的ESL-Working连接Shopweb的地址信息。服务安装完成后，可执行startService.bat开启所有服务，查看各服务的运行状态是否正常

### 添加用户

登录Shopweb，进行到Shopweb的用户管理界面，进行用户的添加，在使用webpda时，记得修改webpda的默认登录账号、密码。

### 打包

完成所有配置及初始化数据后，将服务进行卸载，然后将整个项目进行压缩，在其它环境中进行安装时，已经初始化好的数据及用户权限等信息会保留在新的环境中继续使用。

## 部分数据定制

在data目录下store.sql文件中可以增加需要初始化到shopweb数据库的sql语句，可使用${}进行动态变量的传值，值的定义在config.propreties中进行定义，key为${key}表达式里的变量。

## 注意事项

修改内存时，需将当前服务重装